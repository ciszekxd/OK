
#include <iostream>
#include <fstream>
#include <iomanip>
using namespace std;
class Otwieracz {
public:
    ifstream plik;
    int machines;
    int zadania;
    int** timesTable;
    int** machinesTable;

    Otwieracz(string path, char* t){
        plik.open(path, ios::in);
        getZadania();
        getMachines();
        timesTable = maketab(zadania,zadania);
        machinesTable = maketab(zadania,zadania);
        if(t == "b"){
            beasley();
        }
        else if (t == "t"){
            tailard();
        }
        else {
            cout << " mode not established "
            exit(1);
        }
    }
protected:
    void getZadania() {
        plik.seekg(0, ios_base::beg);
        plik >> zadania;
    }
    void getMachines(){
        plik.seekg(0, ios_base::beg);
        int x;
        plik >> x;
        plik >> machines;

    }

    int** maketab(int a, int b) {
        int **x = new int *[b];
        for (int i = 0; i < b; ++i) {
            x[i] = new int[a];
        }
        return x;
    }
    void tailard() {
        if (!plik.is_open()) {
            cout << "Unable to open file";
            exit(1);
        }
        int x;
        plik.seekg(0, ios_base::beg);
        for(int i=0; i<6;i++){
            plik >> x;
            }
        plik.seekg(7 ,ios_base::cur);
        for (int i = 0; i < zadania; ++i) {
            for (int j = 0; j < zadania; ++j) {
                plik >> timesTable[i][j];
            }
        }  
        plik.seekg(10 ,ios_base::cur);
        for (int i = 0; i < zadania; ++i) {
            for (int j = 0; j < zadania; ++j) {
                plik >> machinesTable[i][j];
            }
        }
    }
    void beasley() {
        int x, y;
        //plik.open("C:\\Users\\1\\Desktop\\struk.txt");
        //plik.open("source.txt");
        if (!plik.is_open()) {
            cout << "Unable to open file";
            exit(1); // terminate with error
        }
        plik.seekg(0, ios_base::beg);
        plik >> y;
        plik >> x;
        //time = maketab(y,y);
        //machine = maketab(y,y);
        for (int i = 0; i < zadania; ++i) {
            for (int j = 0; j < zadania; ++j) {
                plik >> machinesTable[i][j];
                plik >> timesTable[i][j];
            }
        }
        plik.close();
    }
};
int main(){
    ifstream plik;
    string path = "tai01.txt";
    Otwieracz bulgaria(path, "t");
    cout << bulgaria.zadania << endl;
    cout << bulgaria.machines << endl;
    cout << bulgaria.timesTable[3][6] << endl;
    cout << bulgaria.machinesTable[3][6] << endl;
    return 0;
}
